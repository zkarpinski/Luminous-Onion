package com.zacharykarpinski.luminousonion.model.external.trivy;

import com.fasterxml.jackson.annotation.JsonAlias;
import com.fasterxml.jackson.annotation.JsonIgnoreProperties;
import com.zacharykarpinski.luminousonion.model.Finding;
import jakarta.persistence.Entity;

@JsonIgnoreProperties(ignoreUnknown = true)
@Entity
public class Vulnerability extends Finding {

    @JsonAlias("Description")
    String description;
    @JsonAlias("Title")
    String title;
    @JsonAlias("PkgName")
    String packageName;
    @JsonAlias("PkgPath")
    String packagePath;
    @JsonAlias("InstalledVersion")
    String packageVersionFound;
    @JsonAlias("FixedVersion")
    String packageVersionFixed;

    @JsonAlias("VulnerabilityID")
    String findingIdentifier;
    @JsonAlias("Severity")
    String severity;
    @JsonAlias("PrimaryURL")
    private String primaryUrl;

    // Custom calculations
    @Override
    public String getTitle() {
        return "%s:%s | %s".formatted(packageName, packageVersionFound, findingIdentifier);
    }
}
